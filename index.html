<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Combat Pokémon - Selection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #000;
            overflow: hidden;
            height: 100vh;
            text-transform: uppercase;
            color: white;
        }

        #start-screen, #confirmation-screen {
            background: #000;
            color: white;
            transition: opacity 0.5s ease-out;
            opacity: 1;
            z-index: 20; 
        }
        
        .starter-card {
            background: rgba(255, 255, 255, 0.1);
            border: 4px solid white; 
            transition: all 0.3s ease;
            box-shadow: none; 
            border-radius: 0; 
        }
        .starter-card.selected {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
        }
        .starter-card:hover:not(.selected) {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: none; 
        }
        
        .starter-card img {
            width: 100px;
            height: 100px;
            image-rendering: pixelated;
        }
    </style>
</head>
<body class="flex items-center justify-center h-screen">

    <div id="start-screen" class="absolute inset-0 z-20 flex flex-col items-center justify-center p-8">
        <h1 class="text-3xl font-bold mb-4 text-shadow">Bienvenue a Kalos !</h1>
        <p class="text-lg mb-12">Professeur Platane vous attend. Choisissez votre Pokemon !</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10" id="starter-selection-cards">
            
            <div id="select-marisson" class="starter-card p-6 text-center cursor-pointer" data-starter="marisson">
                <img src="marisson.png" alt="Marisson" class="mx-auto mb-4">
                <h2 class="text-xl font-bold">Marisson</h2>
                <span class="px-3 py-1 bg-green-500 text-white font-semibold">Plante</span>
            </div>
            
            <div id="select-feunnec" class="starter-card p-6 text-center cursor-pointer" data-starter="feunnec">
                <img src="feunnec.png" alt="Feunnec" class="mx-auto mb-4">
                <h2 class="text-xl font-bold">Feunnec</h2>
                <span class="px-3 py-1 bg-red-500 text-white font-semibold">Feu</span>
            </div>
            
            <div id="select-grenousse" class="starter-card p-6 text-center cursor-pointer" data-starter="grenousse">
                <img src="grenousse.png" alt="Grenousse" class="mx-auto mb-4">
                <h2 class="text-xl font-bold">Grenousse</h2>
                <span class="px-3 py-1 bg-blue-500 text-white font-semibold">Eau</span>
            </div>
        </div>
    </div>
    
    <div id="confirmation-screen" class="absolute inset-0 z-20 hidden opacity-0 flex flex-col items-center justify-center p-8">
        <h1 class="text-3xl font-bold mb-8">Votre compagnon :</h1>
        
        <div id="chosen-pokemon-display" class="starter-card p-8 text-center mb-12">
            </div>

        <button id="start-adventure-button" 
                class="px-8 py-4 text-2xl bg-yellow-500 text-black border-4 border-white font-bold hover:bg-yellow-600 transition-all duration-200">
            Commencer l'aventure !
        </button>
    </div>

    <script>
        // ==========================================================
        // --- BASE DE DONNÉES POKÉMON (Copie nécessaire pour l'écran de sélection) ---
        // ==========================================================
        const pokemonDB = {
            marisson: { name: "Marisson", type: "Plante", image: "marisson.png" },
            feunnec: { name: "Feunnec", type: "Feu", image: "feunnec.png" },
            grenousse: { name: "Grenousse", type: "Eau", image: "grenousse.png" }
        };

        // ==========================================================
        // --- VARIABLES GLOBALES ET DOM ---
        // ==========================================================
        let playerChoiceKey = ''; // Stocke la clé ('marisson', 'feunnec', 'grenousse')

        const startScreen = document.getElementById('start-screen');
        const confirmationScreen = document.getElementById('confirmation-screen');
        const chosenPokemonDisplay = document.getElementById('chosen-pokemon-display');
        const startAdventureButton = document.getElementById('start-adventure-button');

        // ==========================================================
        // --- LOGIQUE DE SÉLECTION ET REDIRECTION ---
        // ==========================================================
        
        // Attacher les écouteurs pour la sélection
        document.getElementById('starter-selection-cards').addEventListener('click', (event) => {
            const card = event.target.closest('.starter-card');
            if (card) {
                const choice = card.getAttribute('data-starter');
                if (choice) {
                    document.querySelectorAll('.starter-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    startGame(choice); 
                }
            }
        });
        
        // Attacher l'écouteur du nouveau bouton "Commencer l'aventure"
        startAdventureButton.addEventListener('click', startExplorationFromConfirmation);


        function startGame(playerChoice) {
            playerChoiceKey = playerChoice; // Enregistrer le choix
            const chosenPokemon = pokemonDB[playerChoice];
            
            // 1. Remplir l'écran de confirmation
            chosenPokemonDisplay.innerHTML = `
                <img src="${chosenPokemon.image}" alt="${chosenPokemon.name}" class="mx-auto mb-4" style="width: 120px; height: 120px;">
                <h2 class="text-3xl font-bold">${chosenPokemon.name}</h2>
                <span class="px-3 py-1 bg-gray-500 text-white font-semibold">${chosenPokemon.type}</span>
            `;
            
            // 2. Transition vers l'écran de confirmation
            startScreen.style.opacity = '0';
            startScreen.style.pointerEvents = 'none';
            
            setTimeout(() => {
                startScreen.classList.add('hidden');
                confirmationScreen.classList.remove('hidden');
                
                setTimeout(() => {
                    confirmationScreen.style.opacity = '1';
                }, 50);
            }, 500);
        }

        function startExplorationFromConfirmation() {
            // Sauvegarder le choix du Pokémon dans le localStorage pour que jeu.html puisse le récupérer
            if (playerChoiceKey) {
                localStorage.setItem('chosenPokemon', playerChoiceKey);
                
                // Rediriger vers la nouvelle page de jeu
                window.location.href = 'jeu.html';
                
            } else {
                alert("Veuillez choisir un Pokémon !");
            }
        }
    </script>
</body>

</html>
